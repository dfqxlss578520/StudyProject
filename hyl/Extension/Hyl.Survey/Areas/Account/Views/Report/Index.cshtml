@using Hyl.Core.Domain.Survey;
@using Hyl.Core.Helpers.Utility;
@using Hyl.Core.Domain.Survey.ViewModel;
@model SurveyDirectory
@{
    ViewBag.Title = "Index";
}

<input type="hidden" id="id" name="id" value="@Model.Id">
@Html.Partial("_CollectionAndAnalysis", new CollectionAndAnalysisViewModel() { SurveyId = Model.Id, CollectionAndAnalysis = CollectionAndAnalysis.Analysis })


<div style="clear: both;"></div>
<div id="dwBody">
    <div id="dwBodyContent" class="bodyCenter" style="border:1px solid #C1DAEC;">
        <div id="dwBodyUser">
            <div class="surveyCollectMiddle">
                <div class="surveyCollectTop">
                    <div class="surveyCollectTitleDiv">
                        <span class="surveyCollectTitle">@Utils.NoHTML(Utils.UrlDecode(Model.SurveyName)) </span>
                        <div class="scmTabRight">
                            <a href="" class="sbtn25 sbtn25_2">停止收集</a>
                        </div>
                    </div>
                    <div class="surveyCollectInfoDiv">
                        <span class="surveyCollectInfoLeft">
                            状态：<span class="collectInfoSpan">收集中</span>&nbsp;&nbsp;&nbsp;&nbsp;
                            参与人数：<span class="collectInfoSpan">@Model.AnswerNum</span>
                        </span>
                        <span class="surveyCollectInfoRight">
                            创建时间：<span class="collectInfoSpan">
                                @Model.CreateDate.ToString("yyyy年MM月dd日 HH:mm分")
                            </span>
                        </span>
                    </div>
                </div>
                <div class="surveyCollectMiddleContent">
                    <div style="padding: 15px 25px;overflow: auto;">
                        @*<div style="overflow: auto;">
                            <div style="float: left;">
                                <a href="${ctx }/da/survey-report!defaultReport.action?surveyId=${surveyId }"
                                   class="dw_btn025 tabpic active"><i class="fa fa-tasks"></i>&nbsp;报表</a>
                            </div>
                            <div style="float: right;">
                                <a href="${ctx }/da/my-survey-answer!exportXLS.action?surveyId=${surveyId }"
                                   class="dw_btn025"><i class="fa fa-download"></i>下载数据</a>
                            </div>
                        </div>*@
                        <div style="padding-top:8px;">
                            <div class="" style="border: 1px solid #D1D6DD;padding: 0px;">
                                <table id="content-tableList" width="100%" cellpadding="0" cellspacing="0">
                                    @foreach (Question question in Model.Questions)
                                    {
                                        if (question.QuType != QuType.PARAGRAPH && question.QuType != QuType.PAGETAG)
                                        {
                                            var currentIndex = Model.Questions.IndexOf(question) + 1;
                                            <tr id="quTr_@question.Id">
                                                <td colspan="3">
                                                    <div class="surveyResultQu">
                                                        <input type="hidden" name="quId" value="@question.Id">
                                                        <input type="hidden" name="quType" value="@question.QuType">
                                                        <input type="hidden" name="quAnCount" value="@question.AnswerCount">
                                                        <input type="hidden" name="quTypeCnName" value="@question.QuType">
                                                        <div class="r-qu-body-title">
                                                            <div class="quCoNum">@currentIndex、</div>
                                                            <div class="quCoTitleText">@(Html.Raw(Utils.UrlDecode(question.QuName)))[@EnumExtendsion.GetDescription(question.QuType)]</div>
                                                        </div>
                                                        <div class="r-qu-body-content">
                                                            <!--单选题-->
                                                            @if (question.QuType == QuType.RADIO)
                                                            {
                                                                <table class="suQuTable" border="0" cellpadding="0" cellspacing="0">
                                                                    @foreach (var item in question.QuRadios)
                                                                    {
                                                                        var innerIndex = question.QuRadios.IndexOf(item) + 1;
                                                                    <tr class="quTrOptions">
                                                                        <td width="15px">&nbsp;</td>
                                                                        <td width="520px" class="optionName">
                                                                            @Html.Raw(Utils.UrlDecode(item.OptionName))
                                                                        </td>
                                                                        <td width="180px">
                                                                            <div id="bfbTd@(question.QuType)@(currentIndex)_@(innerIndex)" class="progressbarDiv progress@(innerIndex-1)"></div>
                                                                        </td>
                                                                        <td width="60px" align="right" id="bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)" class="bfbTd">
                                                                            0%
                                                                        </td>
                                                                        <td align="left" class="tdAnCount">
                                                                            &nbsp;&nbsp;@(item.AnswerCount)次
                                                                        </td>
                                                                        <td width="40px">
                                                                            &nbsp;
                                                                            <input type="hidden" name="quItemAnCount" value="@item.AnswerCount">
                                                                        </td>
                                                                    </tr>
                                                                    <script type="text/javascript">
                                                                                var count = parseInt("@question.QuRadios.Sum(p=>p.AnswerCount)");
                                                                                var anCount = parseInt("@item.AnswerCount");
                                                                                if (count == 0) {
                                                                                    count = 1;
                                                                                }
                                                                                var bfbFloat = anCount / count * 100;
                                                                                var bfbVal = bfbFloat.toFixed(2);
                                                                                $("#bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)").html(bfbVal + "%");
                                                                                $("#bfbTd@(question.QuType)@(currentIndex)_@(innerIndex)").progressbar({ value: bfbFloat });
                                                                    </script>
                                                                    }
                                                                </table>
                                                                <div class="reportPic">
                                                                    <div class="chartBtnEvent">
                                                                        <a href="#"
                                                                           class="dw_btn026 columnchart_pic">
                                                                            <i class="fa fa-bar-chart"></i>柱状图
                                                                        </a>
                                                                        <a href="#"
                                                                           class="dw_btn026 piechart_pic">
                                                                            <i class="fa fa-pie-chart"></i>饼图
                                                                        </a>
                                                                        <a href="#"
                                                                           class="dw_btn026 barchart_pic">
                                                                            <i class="fa fa-tasks"></i>条形图
                                                                        </a>
                                                                        <a href="#" class="dw_btn026 linechart_pic">
                                                                            <i class="fa fa-line-chart"></i>折线图
                                                                        </a>
                                                                    </div>
                                                                    <div style="clear: both;"></div>
                                                                    <div id="amchart_@question.Id"></div>
                                                                </div>
                                                                <div style="clear:both;"></div>
                                                            }
                                                            else if (question.QuType == QuType.CHECKBOX)
                                                            {
                                                                <!--多选题-->
                                                                <table class="suQuTable" border="0" cellpadding="0" cellspacing="0">
                                                                    @foreach (var item in question.QuCheckboxes)
                                                                    {
                                                                        var innerIndex = question.QuCheckboxes.IndexOf(item) + 1;
                                                                    <tr class="quTrOptions">
                                                                        <td width="15px">&nbsp;</td>
                                                                        <td width="520px" class="optionName">
                                                                            @Html.Raw(Utils.UrlDecode(item.OptionName))
                                                                        </td>
                                                                        <td width="180px">
                                                                            <div id="bfbTd@(question.QuType)@(currentIndex)_@(innerIndex)" class="progressbarDiv progress@(innerIndex-1)"></div>
                                                                        </td>
                                                                        <td width="60px" align="right" id="bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)" class="bfbTd">
                                                                            0%
                                                                        </td>
                                                                        <td align="left" class="tdAnCount">
                                                                            &nbsp;&nbsp;@(item.AnswerCount)次
                                                                        </td>
                                                                        <td width="40px">
                                                                            &nbsp; <input type="hidden" name="quItemAnCount" value="@item.AnswerCount">
                                                                        </td>
                                                                    </tr>
                                                                    <script type="text/javascript">
                                                                                var count = parseInt("@question.AnswerCount");
                                                                                var anCount = parseInt("@item.AnswerCount");
                                                                                var bfbFloat = anCount / count * 100;
                                                                                var bfbVal = bfbFloat.toFixed(2);
                                                                                if (bfbVal === "NaN") {
                                                                                    bfbVal = "0.00";
                                                                                }
                                                                                $("#bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)").html(bfbVal + "%");
                                                                                $("#bfbTd@(question.QuType)@(currentIndex)_@(innerIndex)").progressbar({ value: bfbFloat });
                                                                    </script>
                                                                    }
                                                                </table>
                                                                <div class="reportPic">
                                                                    <div class="chartBtnEvent">
                                                                        <a href="#"
                                                                           class="dw_btn026 columnchart_pic">
                                                                            <i class="fa fa-bar-chart"></i>柱状图
                                                                        </a>
                                                                        <a href="#"
                                                                           class="dw_btn026 piechart_pic">
                                                                            <i class="fa fa-pie-chart"></i>饼图
                                                                        </a>
                                                                        <a href="#"
                                                                           class="dw_btn026 barchart_pic">
                                                                            <i class="fa fa-tasks"></i>条形图
                                                                        </a>
                                                                        <a href="#" class="dw_btn026 linechart_pic">
                                                                            <i class="fa fa-line-chart"></i>折线图
                                                                        </a>
                                                                    </div>
                                                                    <div style="clear: both;"></div>
                                                                    <div id="amchart_@question.Id"></div>
                                                                </div>
                                                                <div style="clear:both;"></div>
                                                            }
                                                            else if (question.QuType == QuType.FILLBLANK)
                                                            {
                                                                <!--填空-->
                                                                <table class="suQuTable" border="0" cellpadding="0"
                                                                       cellspacing="0"
                                                                       style="border: none! important;margin-top: 8px;">
                                                                    <tr>
                                                                        <td width="15px">&nbsp;</td>
                                                                        <td class="bfbTd">
                                                                            回答数：@(question.AnswerCount)条&nbsp;&nbsp;<a href="#" style="display:none;">查看</a>
                                                                        </td>
                                                                        <td colspan="4">&nbsp;</td>
                                                                    </tr>
                                                                </table>
                                                                <div style="clear:both;"></div>
                                                            }
                                                            else if (question.QuType == QuType.ORDERQU)
                                                            {
                                                                var list = question.QuOrderbies.OrderBy(p => p.SumNum).ToList();
                                                                <table class="suQuTable" border="0" cellpadding="0" cellspacing="0">
                                                                    @foreach (var item in list)
                                                                    {
                                                                        var innerIndex = list.IndexOf(item) + 1;
                                                                        <tr class="quTrOptions">
                                                                            <td width="15px">&nbsp;</td>
                                                                            <td width="520px" class="optionName">
                                                                                @Html.Raw(Utils.UrlDecode(item.OptionName))
                                                                            </td>
                                                                            <td colspan="3" align="left" class="tdAnCount">
                                                                                &nbsp;&nbsp;排第&nbsp;@(innerIndex)&nbsp;名
                                                                            </td>
                                                                            <td width="40px">
                                                                                &nbsp;
                                                                                <input type="hidden" name="quItemAnCount" value="@(innerIndex)">
                                                                            </td>
                                                                        </tr>
                                                                    }
                                                                </table>
                                                                <div class="reportPic">
                                                                    <div class="chartBtnEvent">
                                                                        <a href="#"
                                                                           class="dw_btn026 columnchart_pic">
                                                                            <i class="fa fa-bar-chart"></i>柱状图
                                                                        </a>
                                                                        <a href="#"
                                                                           class="dw_btn026 barchart_pic">
                                                                            <i class="fa fa-tasks"></i>条形图
                                                                        </a>
                                                                        <a href="#" class="dw_btn026 linechart_pic">
                                                                            <i class="fa fa-line-chart"></i>折线图
                                                                        </a>
                                                                    </div>
                                                                    <div style="clear: both;"></div>
                                                                    <div id="amchart_@question.Id"></div>
                                                                </div>
                                                                <div style="clear:both;"></div>
                                                            }
                                                            else if (question.QuType == QuType.MULTIFILLBLANK)
                                                            {
                                                                <!--组合填空-->
                                                                <table class="suQuTable" border="0" cellpadding="0" cellspacing="0">
                                                                    @foreach (var item in question.QuMultiFillblanks)
                                                                    {
                                                                        <tr class="quTrOptions">
                                                                            <td width="15px">&nbsp;</td>
                                                                            <td width="520px">@Html.Raw(Utils.UrlDecode(item.OptionName))</td>
                                                                            <td class="bfbTd">
                                                                                回答数：@(item.AnswerCount)条&nbsp;&nbsp;<a href="#" style="display:none;">查看</a>
                                                                            </td>

                                                                            <td colspan="4"></td>
                                                                        </tr>
                                                                    }
                                                                </table>
                                                                <div class="reportPic"></div>
                                                                <div style="clear:both;"></div>
                                                            }
                                                            else if (question.QuType == QuType.SCORE)
                                                            {
                                                                <!--评分题-->
                                                                <input type="hidden" name="paramInt02" value="@question.ParamInt02">
                                                                <table class="suQuTable" border="0" cellpadding="0" cellspacing="0">
                                                                    @foreach (var item in question.QuScores)
                                                                    {
                                                                        var innerIndex = question.QuScores.IndexOf(item) + 1;
                                                                        <tr class="quTrOptions">
                                                                            <td width="15px">&nbsp;</td>
                                                                            <td width="520px" class="optionName">
                                                                                @Html.Raw(Utils.UrlDecode(item.OptionName))
                                                                            </td>
                                                                            <td width="180px">
                                                                                <div id="bfbTd@(question.QuType)@(currentIndex)_@(innerIndex)" class="progressbarDiv progress@(innerIndex-1)"></div>
                                                                            </td>
                                                                            <td width="60px" align="right" id="bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)" class="bfbTd">
                                                                                0%
                                                                            </td>
                                                                            <td align="left" class="tdAnCount">
                                                                                &nbsp;&nbsp;平均
                                                                            </td>
                                                                            <td width="40px">
                                                                                &nbsp;
                                                                                <input type="hidden" name="quItemAnCount" value="@item.AnswerCount">
                                                                                <input type="hidden" name="quItemAvgScore" value="@item.AvgNum">
                                                                            </td>
                                                                        </tr>
                                                                        <script type="text/javascript">
                                                                                var count = parseInt("@question.AnswerCount");
                                                                                var anCount = parseInt("@item.AnswerCount");
                                                                                var avgScore = parseFloat("@item.AvgNum");
                                                                                var bfbFloat = avgScore / "@question.ParamInt02" * 100;
                                                                                var bfbVal = bfbFloat.toFixed(2);
                                                                                //平均分 setAvgScore
                                                                                avgScore = avgScore.toFixed(2);
                                                                                if (avgScore === "NaN") {
                                                                                    avgScore = "0.00";
                                                                                }
                                                                                $("#bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)").html(avgScore + "分");
                                                                                $("#bfbTd@(question.QuType)@(currentIndex)_@(innerIndex)").progressbar({ value: bfbFloat });
                                                                        </script>
                                                                    }
                                                                </table>
                                                                <div class="reportPic">
                                                                    <div class="chartBtnEvent">
                                                                        <a href="#"
                                                                           class="dw_btn026 columnchart_pic">
                                                                            <i class="fa fa-bar-chart"></i>柱状图
                                                                        </a>
                                                                        <a href="#"
                                                                           class="dw_btn026 piechart_pic">
                                                                            <i class="fa fa-pie-chart"></i>饼图
                                                                        </a>
                                                                        <a href="#"
                                                                           class="dw_btn026 barchart_pic">
                                                                            <i class="fa fa-tasks"></i>条形图
                                                                        </a>
                                                                        <a href="#" class="dw_btn026 linechart_pic">
                                                                            <i class="fa fa-line-chart"></i>折线图
                                                                        </a>
                                                                    </div>
                                                                    <div style="clear: both;"></div>
                                                                    <div id="amchart_@question.Id"></div>
                                                                </div>
                                                                <div style="clear:both;"></div>
                                                            }
                                                            else if (question.QuType == QuType.CHENRADIO)
                                                            {
                                                                <!--矩阵单选题-->
                                                                <table class="suQuTable" border="0" cellpadding="0" cellspacing="0">
                                                                    @foreach (var item in question.QuChenRows)
                                                                    {
                                                                        var innerIndex = question.QuChenRows.IndexOf(item) + 1;
                                                                        <tr class="rowItemTr">
                                                                            <td width="15px">
                                                                                <div class="rowItemOptionName" style="display: none;">@Html.Raw(Utils.UrlDecode(item.OptionName))</div>
                                                                                <input type="hidden" name="rowItemAnCount" value="@item.AnswerCount">
                                                                            </td>
                                                                            <td class="quChenRowTd" colspan="5">
                                                                                <label class="editAble quCoOptionEdit" style="font-size: 14px;">
                                                                                    @(innerIndex)、@Html.Raw(Utils.UrlDecode(item.OptionName))
                                                                                </label>
                                                                            </td>
                                                                        </tr>
                                                                        <tr class="columnItemTr">
                                                                            <td colspan="6">
                                                                                <table class="anColumnTable">
                                                                                    @foreach (var colitem in question.QuChenColumns)
                                                                                    {
                                                                                        var innerColumnIndex = question.QuChenColumns.IndexOf(colitem) + 1;
                                                                                        <tr class="columnItemTr">
                                                                                            <td width="15px">
                                                                                                &nbsp;
                                                                                            </td>
                                                                                            <td width="520" class="quChenRowTd" style="padding-left: 15px;">
                                                                                                <label class="editAble quCoOptionEdit">
                                                                                                    @Html.Raw(Utils.UrlDecode(colitem.OptionName))
                                                                                                </label>
                                                                                            </td>
                                                                                            <td width="180px">
                                                                                                <div id="bfbTd@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)" class="progressbarDiv progress@(innerIndex)">
                                                                                                </div>
                                                                                            </td>
                                                                                            <td width="50px" align="right" id="bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)" class="bfbTd">
                                                                                                0%
                                                                                            </td>
                                                                                            <td align="left" id="bfbAnCount@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)" class="tdAnCount">
                                                                                                &nbsp;0次
                                                                                            </td>
                                                                                            <td>
                                                                                                <div class="columnItemOptionName" style="display: none;">@Html.Raw(Utils.UrlDecode(colitem.OptionName))</div>
                                                                                                <input type="hidden" name="columnItemAnCount" value="0" id="coumneItemAnCount@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)">
                                                                                                @foreach (var answerItem in question.AnChenRadio)
                                                                                                {
                                                                                                    if (item.Id == answerItem.QuRowId && colitem.Id == answerItem.QuColId)
                                                                                                    {
                                                                                                        <script type="text/javascript">
                                                                                                            var count = parseInt("@item.AnswerCount");
                                                                                                            var anCount = parseInt("@answerItem.Count");
                                                                                                            var bfbFloat = anCount / count * 100;
                                                                                                            var bfbVal = bfbFloat.toFixed(2);
                                                                                                            if (bfbVal === "NaN") {
                                                                                                                bfbVal = "0.00";
                                                                                                            }
                                                                                                            $("#bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)").html(bfbVal + "%");
                                                                                                            $("#bfbAnCount@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)").html("&nbsp;&nbsp;" + anCount + "次");
                                                                                                            $("#bfbTd@(question.QuType)@(currentIndex)_@(innerIndex)_@innerColumnIndex").progressbar({ value: bfbFloat });

                                                                                                            $("#coumneItemAnCount@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)").val(anCount);

                                                                                                        </script>
                                                                                                    }
                                                                                                }
                                                                                            </td>
                                                                                        </tr>
                                                                                    }
                                                                                </table>
                                                                            </td>
                                                                        </tr>
                                                                    }
                                                                </table>
                                                                <div class="reportPic">
                                                                    <div class="chartBtnEvent">
                                                                        <a href="#"
                                                                           class="dw_btn026 columnchart_pic">
                                                                            <i class="fa fa-bar-chart"></i>柱状图
                                                                        </a>
                                                                        <a href="#"
                                                                           class="dw_btn026 piechart_pic">
                                                                            <i class="fa fa-pie-chart"></i>饼图
                                                                        </a>
                                                                        <a href="#"
                                                                           class="dw_btn026 barchart_pic">
                                                                            <i class="fa fa-tasks"></i>条形图
                                                                        </a>
                                                                        <a href="#" class="dw_btn026 linechart_pic">
                                                                            <i class="fa fa-line-chart"></i>折线图
                                                                        </a>
                                                                    </div>
                                                                    <div style="clear: both;"></div>
                                                                    <div id="amchart_@question.Id"></div>
                                                                </div>
                                                                <div style="clear:both;"></div>
                                                            }
                                                            else if (question.QuType == QuType.CHENCHECKBOX)
                                                            {
                                                                <!--矩阵多选题-->
                                                                <table class="suQuTable" border="0" cellpadding="0" cellspacing="0">

                                                                    @foreach (var item in question.QuChenRows)
                                                                    {
                                                                        var innerIndex = question.QuChenRows.IndexOf(item) + 1;
                                                                        <tr class="rowItemTr">
                                                                            <td width="15px">
                                                                                &nbsp;
                                                                                <div class="rowItemOptionName"
                                                                                     style="display: none;">@Html.Raw(Utils.UrlDecode(item.OptionName))</div>
                                                                                    <input type="hidden"
                                                                                           name="rowItemAnCount"
                                                                                           value="@item.AnswerCount">
                                                                                </td>
                                                                                <td class="quChenRowTd" colspan="5">
                                                                                    <label class="editAble quCoOptionEdit"
                                                                                           style="font-size: 14px;">@(innerIndex)、@Html.Raw(Utils.UrlDecode(item.OptionName))</label>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr class="columnItemTr">
                                                                                    <td colspan="6">
                                                                                        <table class="anColumnTable"
                                                                                               style="width: 100%;">
                                                                                            @foreach (var colitem in question.QuChenColumns)
                                                                                            {
                                                                                                var innerColumnIndex = question.QuChenColumns.IndexOf(colitem) + 1;
                                                                                                <tr class="columnItemTr">
                                                                                                    <td width="15px">
                                                                                                        &nbsp;
                                                                                                    </td>
                                                                                                    <td width="520" class="quChenRowTd" style="padding-left: 15px;">
                                                                                                        <label class="editAble quCoOptionEdit">@Html.Raw(Utils.UrlDecode(colitem.OptionName))</label>
                                                                                                    </td>
                                                                                                    <td width="180px">
                                                                                                        <div id="bfbTd@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)" class="progressbarDiv progress@(innerIndex)"></div>
                                                                                                    </td>
                                                                                                    <td width="50px" align="right" id="bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)" class="bfbTd">
                                                                                                        0%
                                                                                                    </td>
                                                                                                    <td align="left" id="bfbAnCount@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)" class="tdAnCount">
                                                                                                        &nbsp;0次
                                                                                                    </td>
                                                                                                    <td>
                                                                                                        <div class="columnItemOptionName"
                                                                                                             style="display: none;">@Html.Raw(Utils.UrlDecode(colitem.OptionName))</div>
                                                                                                            <input type="hidden" name="columnItemAnCount" value="0" id="coumneItemAnCount@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)">
                                                                                                            @foreach (var answerItem in question.AnChenCheckbox)
                                                                                                            {
                                                                                                                if (item.Id == answerItem.QuRowId && colitem.Id == answerItem.QuColId)
                                                                                                                {
                                                                                                                    <script type="text/javascript">
                                                                                                                        var count = parseInt("@item.AnswerCount");
                                                                                                                        var anCount = parseInt("@answerItem.Count");
                                                                                                                        var bfbFloat = anCount / count * 100;
                                                                                                                        var bfbVal = bfbFloat.toFixed(2);
                                                                                                                        if (bfbVal === "NaN") {
                                                                                                                            bfbVal = "0.00";
                                                                                                                        }
                                                                                                                        $("#bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)").html(bfbVal + "%");
                                                                                                                        $("#bfbAnCount@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)").html("&nbsp;&nbsp;" + anCount + "次");
                                                                                                                        $("#bfbTd@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)").progressbar({ value: bfbFloat });

                                                                                                                        $("#coumneItemAnCount@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)").val(anCount);
                                                                                                                    </script>
                                                                                                                }
                                                                                                            }
                                                                                                        </td>
                                                                                                    </tr>
                                                                                            }
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>

                                                                    }
                                                                </table>
                                                                <div class="reportPic">
                                                                    <div class="chartBtnEvent">
                                                                        <a href="#"
                                                                           class="dw_btn026 columnchart_pic">
                                                                            <i class="fa fa-bar-chart"></i>柱状图
                                                                        </a>
                                                                        <a href="#"
                                                                           class="dw_btn026 piechart_pic">
                                                                            <i class="fa fa-pie-chart"></i>饼图
                                                                        </a>
                                                                        <a href="#"
                                                                           class="dw_btn026 barchart_pic">
                                                                            <i class="fa fa-tasks"></i>条形图
                                                                        </a>
                                                                        <a href="#" class="dw_btn026 linechart_pic">
                                                                            <i class="fa fa-line-chart"></i>折线图
                                                                        </a>
                                                                    </div>
                                                                    <div style="clear: both;"></div>
                                                                    <div id="amchart_@question.Id"></div>
                                                                </div>
                                                                <div style="clear:both;"></div>
                                                            }
                                                            else if (question.QuType == QuType.CHENSCORE)
                                                            {
                                                                <!--矩阵评分题-->
                                                                <table class="suQuTable" border="0" cellpadding="0" cellspacing="0">
                                                                    @foreach (var item in question.QuChenRows)
                                                                    {
                                                                        var innerIndex = question.QuChenRows.IndexOf(item) + 1;
                                                                        <tr class="rowItemTr">
                                                                            <td width="15px">
                                                                                &nbsp;
                                                                                <div class="rowItemOptionName" style="display: none;">@Html.Raw(Utils.UrlDecode(item.OptionName))</div>
                                                                                <input type="hidden" name="rowItemAnCount" value="@item.AnswerCount">
                                                                            </td>
                                                                            <td class="quChenRowTd" colspan="5">
                                                                                <label class="editAble quCoOptionEdit"
                                                                                       style="font-size: 14px;">@(innerIndex)、@Html.Raw(Utils.UrlDecode(item.OptionName))</label>
                                                                                </td>
                                                                            </tr>
                                                                            <tr class="columnItemTr">
                                                                                <td colspan="6">
                                                                                    <table class="anColumnTable">
                                                                                        @foreach (var colitem in question.QuChenColumns)
                                                                                        {
                                                                                            var innerColumnIndex = question.QuChenColumns.IndexOf(colitem) + 1;
                                                                                            <tr class="columnItemTr">
                                                                                                <td width="15px">&nbsp;</td>
                                                                                                <td width="520" class="quChenRowTd" style="padding-left: 15px;">
                                                                                                    <label class="editAble quCoOptionEdit">@Html.Raw(Utils.UrlDecode(colitem.OptionName))</label>
                                                                                                </td>
                                                                                                <td width="180px">
                                                                                                    <div id="bfbTd@(question.QuType)@(currentIndex)_@(innerIndex)_@innerColumnIndex" class="progressbarDiv progress@(innerIndex)"></div>
                                                                                                </td>
                                                                                                <td width="60px" align="right" id="bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)" class="bfbTd">
                                                                                                    0%
                                                                                                </td>
                                                                                                <td align="left" class="tdAnCount">
                                                                                                    &nbsp;&nbsp;平均
                                                                                                </td>
                                                                                                <td width="40px">&nbsp;</td>
                                                                                                <td>
                                                                                                    <div class="columnItemOptionName"
                                                                                                         style="display: none;">@Html.Raw(Utils.UrlDecode(colitem.OptionName))</div>
                                                                                                        <input type="hidden" name="columnItemAnCount" value="0" id="coumneItemAnCount@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)">
                                                                                                        @foreach (var answerItem in question.AnChenScore)
                                                                                                        {
                                                                                                            if (answerItem.QuRowId == item.Id && colitem.Id == answerItem.QuColId)
                                                                                                            {
                                                                                                                <script type="text/javascript">
                                                                                                                        var avgScore = parseFloat("@answerItem.AvgScore");
                                                                                                                        var bfbFloat = avgScore / 5 * 100;
                                                                                                                        var bfbVal = bfbFloat.toFixed(2);
                                                                                                                        //平均分 setAvgScore
                                                                                                                        avgScore = avgScore.toFixed(2);
                                                                                                                        if (avgScore === "NaN") {
                                                                                                                            avgScore = "0.00";
                                                                                                                        }
                                                                                                                        $("#bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)").html(avgScore + "分");
                                                                                                                        $("#bfbTd@(question.QuType)@(currentIndex)_@(innerIndex)_@innerColumnIndex").progressbar({ value: bfbFloat });

                                                                                                                        $("#coumneItemAnCount@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)").val(avgScore);
                                                                                                                </script>
                                                                                                            }
                                                                                                        }
                                                                                                    </td>
                                                                                                </tr>
                                                                                        }
                                                                                    </table>
                                                                                </td>
                                                                            </tr>
                                                                    }

                                                                </table>
                                                                <div class="reportPic">
                                                                    <div class="chartBtnEvent">
                                                                        <a href="#"
                                                                           class="dw_btn026 columnchart_pic">
                                                                            <i class="fa fa-bar-chart"></i>柱状图
                                                                        </a>
                                                                        <a href="#"
                                                                           class="dw_btn026 piechart_pic">
                                                                            <i class="fa fa-pie-chart"></i>饼图
                                                                        </a>
                                                                        <a href="#"
                                                                           class="dw_btn026 barchart_pic">
                                                                            <i class="fa fa-tasks"></i>条形图
                                                                        </a>
                                                                        <a href="#" class="dw_btn026 linechart_pic">
                                                                            <i class="fa fa-line-chart"></i>折线图
                                                                        </a>
                                                                    </div>
                                                                    <div style="clear: both;"></div>
                                                                    <div id="amchart_@question.Id"></div>
                                                                </div>
                                                                <div style="clear:both;"></div>
                                                            }
                                                            else if (question.QuType == QuType.CHENFBK)
                                                            {
                                                                <!--矩阵填空题-->
                                                                <table class="suQuTable" border="0" cellpadding="0"
                                                                       cellspacing="0">

                                                                    @foreach (var item in question.QuChenRows)
                                                                    {
                                                                        var innerIndex = question.QuChenRows.IndexOf(item) + 1;
                                                                        <tr class="rowItemTr">
                                                                            <td width="15px">&nbsp;</td>
                                                                            <td class="quChenRowTd" colspan="4">
                                                                                <label class="editAble quCoOptionEdit"
                                                                                       style="font-size: 14px;">@(innerIndex)、@Html.Raw(Utils.UrlDecode(item.OptionName))</label>
                                                                                </td>
                                                                            </tr>
                                                                        foreach (var colitem in question.QuChenColumns)
                                                                        {
                                                                            var innerColumnIndex = question.QuChenColumns.IndexOf(colitem) + 1;
                                                                            <tr class="columnItemTr">
                                                                                <td width="15px">&nbsp;</td>
                                                                                <td width="520" class="quChenRowTd"
                                                                                    style="padding-left: 15px;">
                                                                                    <label class="editAble quCoOptionEdit">@Html.Raw(Utils.UrlDecode(colitem.OptionName))</label>
                                                                                </td>
                                                                                <td width="120px" align="left"
                                                                                    id="bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)"
                                                                                    class="bfbTd">
                                                                                    0%
                                                                                </td>
                                                                                <td align="left"
                                                                                    id="bfbAnCount@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)"
                                                                                    class="tdAnCount">
                                                                                    &nbsp;0次
                                                                                </td>
                                                                                <td width="40px">&nbsp;</td>
                                                                                <td>
                                                                                    @foreach (var answerItem in question.AnChenFillblank)
                                                                                    {
                                                                                        if (answerItem.QuRowId == item.Id && answerItem.QuColId == colitem.Id)
                                                                                        {
                                                                                            <script type="text/javascript">
                                                                                $("#bfbNum@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)").html("回答数：@(answerItem.Count)条");
                                                                                                $("#bfbAnCount@(question.QuType)@(currentIndex)_@(innerIndex)_@(innerColumnIndex)").html("&nbsp;&nbsp;<a href=\"#\" style=\"display:none;\">查看</a>");
                                                                                            </script>
                                                                                        }
                                                                                    }
                                                                                </td>
                                                                            </tr>
                                                                        }
                                                                    }
                                                                </table>
                                                                <div class="reportPic"></div>
                                                                <div style="clear:both;"></div>
                                                                <div class="quItemNote">@question.QuNote</div>
                                                            }

                                                        </div>
                                                    </div>

                                                </td>
                                            </tr>
                                        }
                                    }
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="/Content/js/plugs/echarts/echarts-master/dist/echarts.js"></script>
<script src="/Content/js/plugs/echarts/echarts-master/theme/shine.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $(".linechart_pic,.piechart_pic,.barchart_pic,.columnchart_pic").click(function () {
            var th = $(this);
            var thClass = th.attr("class");
            var quId = th.parents(".surveyResultQu").find("input[name='quId']").val();
            var amchartdivId = null;
            if (thClass.indexOf("linechart_pic") > 0) {
                amchartdivId = "line_chart_" + quId;
            } else if (thClass.indexOf("piechart_pic") > 0) {
                amchartdivId = "pie_chart_" + quId;
            } else if (thClass.indexOf("barchart_pic") > 0) {
                amchartdivId = "bar_chart_" + quId;
            } else if (thClass.indexOf("columnchart_pic") > 0) {
                amchartdivId = "column_chart_" + quId;
            }
            th.parent().find(".dw_btn026.active").removeClass("active");
            th.addClass("active");

            if (amchartdivId != null) {
                var amchartdivObj = $("#" + amchartdivId);
                if (!amchartdivObj[0]) {
                    var url = "@Url.Action("ChartData", "Report")";
                    var data = "quId=" + quId;
                    $.ajax({
                        url: url,
                        data: data,
                        type: "post",
                        success: function (msg) {

                            $("#amchart_" + quId).find(".higChartSvg").hide();

                            if (thClass.indexOf("linechart_pic") > 0) {
                                //buildChart(msg,quId);
                                higLineChart(msg, quId);
                            } else if (thClass.indexOf("piechart_pic") > 0) {
                                //buildPieChart(msg,quId);
                                higPieChart(msg, quId);
                            } else if (thClass.indexOf("barchart_pic") > 0) {
                                higBarChart(msg, quId);
                            } else if (thClass.indexOf("columnchart_pic") > 0) {
                                higColumnChart(msg, quId);
                            }

                        }
                    });
                } else {
                    $("#amchart_" + quId).find(".higChartSvg").hide();
                    amchartdivObj.show();
                }
            }

            return false;
        });
        $(".columnchart_pic").click();
        resetQuNum();
        function resetQuNum() {
            var quCoNums = $(".quCoNum");
            $.each(quCoNums, function (i, item) {
                $(this).html((i + 1) + "、");
            });
        }
    });


    function getHighchartsData(quItemBody, charType) {
        var quType = quItemBody.find("input[name='quType']").val();

        var categories = [];
        var series = new Array();
        var seriesData = new Array();
        var tagText = "次数";
        var legendData = new Array();

        var seriesType = 'bar';
        if (charType === "Line") {
            seriesType = 'line';
        }

        if (quType === "CHENRADIO" || quType === "CHENCHECKBOX" || quType === "CHENSCORE") {

            if (charType === "PIE") {
                seriesData = new Array();
                var rowItemTrs = quItemBody.find(".rowItemTr");
                $.each(rowItemTrs, function () {
                    var rowItemOptionName = $(this).find(".rowItemOptionName").text();
                    var thColumnItemTrs = $(this).next().find(".columnItemTr");
                    $.each(thColumnItemTrs, function () {
                        var columnItemOptionName = $(this).find(".columnItemOptionName").text();
                        var anCount = $(this).find("input[name='columnItemAnCount']").val();

                        var data = {};
                        data["value"] = parseInt(anCount);
                        data["name"] = rowItemOptionName + "|" + columnItemOptionName;
                        series.push(data);

                    });
                });
            } else {
                var columnItemTrs = quItemBody.find(".anColumnTable:eq(0) .columnItemTr");
                $.each(columnItemTrs, function () {
                    var columnItemOptionName = $(this).find(".columnItemOptionName").text();
                    categories.push(columnItemOptionName);
                });

                var rowItemTrs = quItemBody.find(".rowItemTr");
                $.each(rowItemTrs, function () {
                    var rowItemOptionName = $(this).find(".rowItemOptionName").text();
                    var thColumnItemTrs = $(this).next().find(".columnItemTr");
                    seriesData = new Array();
                    $.each(thColumnItemTrs, function () {
                        var anCount = $(this).find("input[name='columnItemAnCount']").val();
                        seriesData.push(parseInt(anCount));
                    });
                    series.push({                                 //指定数据列
                        name: rowItemOptionName,                //数据列名
                        //type:'bar',
                        type: seriesType,
                        data: seriesData                      //数据
                    });
                    legendData.push(rowItemOptionName);
                });
            }

        } else {

            var seriesDataTemp = "[";

            var quRadioOptions = quItemBody.find(".quTrOptions");
            $.each(quRadioOptions, function (i, item) {
                var quOptionName = $(this).find(".optionName").text();
                var anCount = $(this).find("input[name='quItemAnCount']").val();

                if (anCount == "") {
                    anCount = 0;
                }
                categories.push(quOptionName);
                if (quType === "SCORE") {
                    var avgScore = $(this).find("input[name='quItemAvgScore']").val();
                    //平均分 setAvgScore
                    avgScore = parseFloat(avgScore).toFixed(2);
                    if (avgScore === "NaN") {
                        avgScore = "0.00";
                    }
                    if (charType === "PIE") {
                        var data = {};
                        data["value"] = parseFloat(avgScore);
                        data["name"] = quOptionName;
                        seriesData.push(data);
                    } else {
                        seriesData.push(parseFloat(avgScore));
                    }
                    tagText = "分数";
                } else if (quType === "ORDERQU") {
                    if (charType === "PIE") {
                        var data = {};
                        data["value"] = parseInt(anCount);
                        data["name"] = quOptionName;
                        seriesData.push(data);
                    } else {
                        seriesData.push(parseInt(anCount));
                    }
                    tagText = "排名";
                } else {
                    if (charType === "PIE") {
                        var data = {};
                        data["value"] = parseInt(anCount);
                        data["name"] = quOptionName;
                        seriesData.push(data);
                    } else {
                        seriesData.push(parseInt(anCount));
                    }
                }


            });

            if (charType === "PIE") {
                series = seriesData;
            } else if (charType === "BAR") {
                series = [{
                    //name: '选项',
                    name: tagText,
                    type: 'bar',
                    data: seriesData
                }];
            } else {
                series = [{
                    name: tagText,
                    type: seriesType,
                    data: seriesData
                }]
            }

        }

        return [categories, series, tagText, legendData];
    }


    function higColumnChart(resultJson, quId) {
        var chartdivId = "column_chart_" + quId;
        $("#amchart_" + quId).prepend("<div id='" + chartdivId + "' class=\"higChartSvg\"></div>");
        $("#" + chartdivId).css({ "height": "300px" });

        var quItemBody = $("#quTr_" + quId);
        var quTitle = quItemBody.find(".quCoTitleText").text();

        var quTypeName = quItemBody.find("input[name='quTypeCnName']").val();

        var datas = getHighchartsData(quItemBody, "column");
        var categories = datas[0];
        var series = datas[1];
        var tagText = datas[2];
        var legendData = datas[3];

        var myChart = echarts.init($('#' + chartdivId)[0], "shine");
        // 指定图表的配置项和数据
        var option = {
            title: {
                text: quTitle,
                top: 8,
                textStyle: {
                    fontSize: 16
                },
                x: 'center'
            },
            toolbox: {
                show: true,
                feature: {
                    saveAsImage: { show: true }
                }
            },
            color: ['#7cb5ec'],
            backgroundColor: '#fff',
            tooltip: {
                trigger: 'axis',
                axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                    type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                },
                top: 20
            },
            grid: {
                left: '3%',
                right: '3%',
                bottom: '5%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                data: categories,
                axisTick: {
                    alignWithLabel: true
                },
                nameGap: 20,
                axisLabel: {
                    //rotate: 5,
                    interval: 0,
                    margin: 15
                },
                axisLine: {
                    show: false,
                    lineStyle: { width: 1 }
                },
                axisTick: {
                    show: false
                }
            },
            yAxis: {
                //minInterval: 2,
                splitNumber: 5,
                //nameLocation: 'middle',
                //boundaryGap: ['30%', '30%'],
                //nameGap: 20,
                type: 'value',
                axisLine: {
                    show: false
                },
                axisTick: {
                    show: false
                },
                name: tagText
            },
            legend: {
                bottom: 0,
                data: legendData
            },
            series: series
        };

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    }

    function higPieChart(resultJson, quId) {
        var chartdivId = "pie_chart_" + quId;
        $("#amchart_" + quId).prepend("<div id='" + chartdivId + "' class=\"higChartSvg\"></div>");
        $("#" + chartdivId).css({ "height": "300px" });

        var quItemBody = $("#quTr_" + quId);
        var quTitle = quItemBody.find(".quCoTitleText").text();
        var quTypeName = quItemBody.find("input[name='quTypeCnName']").val();

        var datas = getHighchartsData(quItemBody, "PIE");
        var series = datas[1];
        var tagText = datas[2];
        var categories = datas[0]
        var legendData = datas[3];

        // Build the chart
        var myChart = echarts.init($('#' + chartdivId)[0], "shine");
        var option = {
            title: {
                text: quTitle,
                top: 8,
                /*  left: 10, */
                textStyle: {
                    fontSize: 16
                },
                x: 'center'
            },
            tooltip: {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            backgroundColor: '#fff',
            toolbox: {
                show: true,
                feature: {
                    saveAsImage: { show: true }
                }
            },
            legend: {
                x: 'center',
                y: 'bottom',
                data: categories//['直接访问','邮件营销','联盟广告','视频广告','搜索引擎']
            },
            series:// series
            [
                {
                    name: tagText,
                    type: 'pie',
                    radius: '55%',
                    center: ['50%', '60%'],
                    data: series,
                    itemStyle: {
                        emphasis: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };
        myChart.setOption(option);

    }


    function higBarChart(resultJson, quId) {

        var chartdivId = "bar_chart_" + quId;
        $("#amchart_" + quId).prepend("<div id='" + chartdivId + "' class=\"higChartSvg\"></div>");
        $("#" + chartdivId).css({ "height": "300px" });

        var quItemBody = $("#quTr_" + quId);
        var quTitle = quItemBody.find(".quCoTitleText").text();
        var quTypeName = quItemBody.find("input[name='quTypeCnName']").val();

        var datas = getHighchartsData(quItemBody, "BAR");
        var categories = datas[0];
        var series = datas[1];
        var tagText = datas[2];
        var legendData = datas[3];

        var myChart = echarts.init($('#' + chartdivId)[0], "shine");
        var option = {
            title: {
                text: quTitle,
                top: 8,
                /*  left: 10, */
                textStyle: {
                    fontSize: 16
                },
                x: 'center'
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                }
            },
            backgroundColor: '#fff',
            color: ['#7cb5ec'],
            legend: {
                data: ['2011年', '2012年']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '10%',
                containLabel: true
            },
            toolbox: {
                show: true,
                feature: {
                    saveAsImage: { show: true }
                }
            },
            xAxis: {
                type: 'value',
                axisTick: {
                    alignWithLabel: true
                },
                nameGap: 12,
                axisLabel: {
                    //rotate: 5,
                    interval: 0,
                    margin: 15
                },
                axisLine: {
                    show: false,
                    lineStyle: { width: 1 }
                },
                axisTick: {
                    show: false
                },
                splitLine: { show: true }
            },
            yAxis: {
                type: 'category',
                data: categories
            },
            legend: {
                bottom: 2,
                data: legendData
            },
            series: series
        };
        myChart.setOption(option);
    }


    function higLineChart(resultJson, quId) {
        //根据quId得到数据对象，并且解析

        var chartdivId = "line_chart_" + quId;
        $("#amchart_" + quId).prepend("<div id='" + chartdivId + "' class=\"higChartSvg\"></div>");
        $("#" + chartdivId).css({ "height": "300px" });

        var quItemBody = $("#quTr_" + quId);
        var quTitle = quItemBody.find(".quCoTitleText").text();
        var quTypeName = quItemBody.find("input[name='quTypeCnName']").val();

        var datas = getHighchartsData(quItemBody, "Line");
        var categories = datas[0];
        var series = datas[1];
        var tagText = datas[2];
        var legendData = datas[3];

        var myChart = echarts.init($('#' + chartdivId)[0], "shine");
        // 指定图表的配置项和数据
        var option = {
            title: {
                text: quTitle,
                top: 8,
                /*  left: 10, */
                textStyle: {
                    fontSize: 16
                },
                x: 'center'
            },
            toolbox: {
                show: true,
                feature: {
                    saveAsImage: { show: true }
                }
            },
            backgroundColor: '#fff',
            color: ['#3398DB'],
            tooltip: {
                trigger: 'axis',
                axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                    type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                },
                top: 20
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                data: categories,
                axisTick: {
                    alignWithLabel: true
                },
                nameGap: 20,
                axisLabel: {
                    //rotate: 5,
                    interval: 0,
                    margin: 15
                },
                axisLine: {
                    show: false,
                    lineStyle: { width: 1 }
                },
                axisTick: {
                    show: false
                },
                splitLine: { show: true }
            },
            yAxis: {
                minInterval: 1,
                name: '次数'
            },
            legend: {
                bottom: 0,
                data: legendData
            },
            series: series
        };
        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);

    }


    function substring(json) {
        var bufLen = json.length;
        var lastIndex = json.lastIndexOf(",");
        if (bufLen == (lastIndex + 1)) {
            json = json.substring(0, lastIndex);
        }
        return json;
    }
</script>
<style type="text/css">
    .dw_btn026 { border: 1px solid transparent; }
    .suQuTable { border: 1px solid #c5b6b6 !important; width: 100%; }
    .anColumnTable { width: 100%; }
    .quTrOptions td { border-top: 1px dashed #c5b6b6 !important; }
    .rowItemTr td { border-top: 1px solid #c5b6b6 !important; }
    .columnItemTr td { border-top: 1px dashed #c5b6b6 !important; }
    .suQuTable .quTrOptions:first-child td, .suQuTable .rowItemTr:first-child td, .suQuTable .columnItemTr:first-child td { border-top: none !important; }
    .r-qu-body-title .quCoNum { float: left; padding: 5px 0px; padding-left: 8px; }
    .r-qu-body-title .quCoTitleText { float: left; padding: 5px 3px; cursor: text; table-layout: fixed; word-break: break-all; display: inline-block; }
</style>